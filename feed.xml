<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://paujuan.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://paujuan.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-06-21T22:11:47+00:00</updated><id>https://paujuan.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">An introduction to PyRQP</title><link href="https://paujuan.github.io/blog/2023/PyRQP/" rel="alternate" type="text/html" title="An introduction to PyRQP"/><published>2023-10-30T00:00:00+00:00</published><updated>2023-10-30T00:00:00+00:00</updated><id>https://paujuan.github.io/blog/2023/PyRQP</id><content type="html" xml:base="https://paujuan.github.io/blog/2023/PyRQP/"><![CDATA[<p>I have written an open source version of the Environment Agency’s River Quality Planning (RQP) software in Python<d-footnote>Juan-Garcia, P. (2023, October 17). PauJuan/PyRQP Open source River Quality Planning software written in Python. GitHub. https://github.com/PauJuan/PyRQP </d-footnote>. I wanted to create a version that is transparent, extendable and easy to automate.</p> <p>Please feel free to check the repository at <a href="https://github.com/PauJuan/PyRQP">https://github.com/PauJuan/PyRQP</a></p> <p>In this post I will discuss what RQP is, some fundamentals on how it works and provide an example to use it.</p> <h3 id="rqp">RQP</h3> <p>RQP is one of the main tools used for discharge permitting and water management in the UK. The main purpose of the tool is to simulate the mixing of two inputs (generally a river and a discharge) to estimate the distribution of the output concentration of the downstream mixing zone. Typical uses of the tool would be to determine the possible impact of an increased flow discharged at a location, or the quality required at a given discharge to meet a specific water quality standard downstream of the discharge. RQP is the model underpinning the functionality implemented by the <a href="https://www.gov.uk/government/organisations/environment-agency">Environment Agency</a>’s catchment simulator SIMCAT and <a href="https://ukwir.org/">UKWIR</a>’s <a href="https://sagis.ukwir.org/sagis/welcome">SAGIS</a>.</p> <p>There are two key points underlying the methodology of the RQP tool:</p> <ol> <li>The input data are correlated. That is, they are dependent on one another and change together to a certain degree.</li> <li>It is possible to simulate the mix of two distributions by using a numerical method such as Monte Carlo (i.e., repeated random sampling to obtain numerical results).</li> </ol> <p>These are explained a continuation.</p> <h3 id="correlation">Correlation</h3> <p>RQP generates four sets of random correlated data based on each parameter’s distributions, which are generally considered to be lognormal. The parameters are: river flow, discharge flow, river concentration and discharge concentration. The following is a graphical representation of what this looks like for river flow and quality. The correlation between river flow and discharge flow is typically 0.6.</p> <p><img src="https://github.com/PauJuan/PyRQP/blob/main/docs/img/Log_normal.png?raw=true" alt="LogNormal"/></p> <p><em>Example of river flow and quality correlation of 0.6 for two lognormal distributions. River flow mean and std are 20 and 4.5; river quality mean and std are 4 and 0.9. These values are approximate</em></p> <h3 id="monte-carlo">Monte Carlo</h3> <p>By applying a simple mass balance, the downstream flow and concentration is calculated. A graphical representation of the Monte Carlo method for mixing distributions is shown below.</p> <p><img src="https://github.com/PauJuan/PyRQP/blob/main/docs/img/RQP_method.png?raw=true" alt="MonteCarlo"/></p> <p><em>Monte Carlo sampling method</em></p> <blockquote> <p>Source: Henderson, Brent &amp; Bui, Elisabeth. (2005). Determining Uncertainty in Sediment &amp; Nutrient Transport Models for Ecological Risk Assessment. Report No 2. LWA/MDBC Project UMO43: Risk-based Approaches to Managing Contaminants in Catchments. CSIRO.</p> </blockquote> <h2 id="installation">Installation</h2> <p>The PyRQP package is available for installation using <a href="https://pypi.org/project/PyRQP/">PyPI</a>:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pip</span> <span class="n">install</span> <span class="n">PyRQP</span>
</code></pre></div></div> <p>However, the pip version may lag behind the release version. For the moment I recommend to clone (or simply download) the repository from GitHub and run it directly by using the example notebooks. It is possible to open and run the notebooks using ArcGIS Pro (where SAGIS is usually run) with no need to install any dependencies.</p> <h2 id="examples">Examples</h2> <p>The main library and all its functions can be used calling:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">rqp</span>
</code></pre></div></div> <p>The following notebook shows a full example of how to use RQP for one case study. The repository contains several <a href="https://github.com/PauJuan/PyRQP/tree/main/notebooks">notebooks</a> with examples on how to use the library. In my next post I will show how to run RQP in batch using an Excel file.</p> <div class="jupyter-notebook" style="position: relative; width: 100%; margin: 0 auto;"> <div class="jupyter-notebook-iframe-container"> <iframe src="/assets/jupyter/rqp_simple_example.ipynb.html" style="position: absolute; top: 0; left: 0; border-style: none;" width="100%" height="100%" onload="this.parentElement.style.paddingBottom = (this.contentWindow.document.documentElement.scrollHeight + 10) + 'px'"></iframe> </div> </div> <hr/> <p>Thanks for reading. If you end up using this library please feel free to drop me an email and let me know. I am happy to provide support where I can.</p>]]></content><author><name>Pau Juan-Garcia</name></author><category term="RQP"/><summary type="html"><![CDATA[Introduction to PyRQP, an open source version of the Environment Agency's River Quality Planning software written in Python.]]></summary></entry></feed>